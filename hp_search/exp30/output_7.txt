python3 main.py --train ../wbi_binary/pre2_train.csv --score --hp randomized 
2017-07-05 07:41:32,981 DEBUG Commandline arguments: Namespace(hp='randomized', hp_metric='accuracy', model=None, oob=False, predict=None, score=True, test_size=0.25, train=<_io.TextIOWrapper name='../wbi_binary/pre2_train.csv' mode='r' encoding='UTF-8'>)
2017-07-05 07:41:32,981 DEBUG Valid mode of operation
2017-07-05 07:41:32,981 INFO Mode score->train
2017-07-05 07:41:32,981 DEBUG Loading data...
2017-07-05 07:41:33,189 INFO Created training set (1616) and test set (539)
2017-07-05 07:41:33,189 INFO Recognised data-set: binary
2017-07-05 07:41:33,190 INFO Using randomized search on the training set to select the best model (hyper-parameters)...
2017-07-05 07:41:33,190 DEBUG Performing randomized search, optimizing accuracy score...
2017-07-05 07:41:33,191 DEBUG Generating feature vector...
Vector union has 1485775 features.
2017-07-05 07:41:50,235 INFO Generated vector of 1485775 features in 0:00:17.043748 from 1616 samples.
Fitting 8 folds for each of 30 candidates, totalling 240 fits
[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed: 11.1min
[Parallel(n_jobs=-1)]: Done 192 tasks      | elapsed: 56.3min
[Parallel(n_jobs=-1)]: Done 240 out of 240 | elapsed: 74.3min finished
Hyper parameter search report:
Parameter search space:
{'clf': [RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='log2', max_leaf_nodes=None,
            min_impurity_split=1e-05, min_samples_leaf=1,
            min_samples_split=2, min_weight_fraction_leaf=0.0,
            n_estimators=10, n_jobs=-1, oob_score=False,
            random_state=<mtrand.RandomState object at 0x7f693f386e58>,
            verbose=0, warm_start=False)],
 'clf__max_depth': [11],
 'clf__max_leaf_nodes': [60, 70, None],
 'clf__min_samples_leaf': [1],
 'clf__min_samples_split': [3],
 'clf__n_estimators': [1100, 1600],
 'select__k': [6000, 10000, 300000, 411500, 455500]}
Best score: 0.936
Best parameters set:
{'clf__max_depth': 11,
 'clf__max_leaf_nodes': 70,
 'clf__min_samples_leaf': 1,
 'clf__min_samples_split': 3,
 'clf__n_estimators': 1600,
 'select__k': 10000}
Detailed folds results:
    mean_fit_time  mean_score_time  mean_test_score  mean_train_score                                          param_clf param_clf__max_depth param_clf__max_leaf_nodes param_clf__min_samples_leaf  \
0       15.573762         1.224262         0.931931          0.976662  (DecisionTreeClassifier(class_weight=None, cri...                   11                        60                           1   
1       16.368082         1.532152         0.932550          0.977812  (DecisionTreeClassifier(class_weight=None, cri...                   11                        60                           1   
2       16.546894         7.243402         0.928837          0.979049  (DecisionTreeClassifier(class_weight=None, cri...                   11                        60                           1   
3       18.910202         7.520703         0.926980          0.979845  (DecisionTreeClassifier(class_weight=None, cri...                   11                        60                           1   
4       20.019313         8.175127         0.929455          0.979845  (DecisionTreeClassifier(class_weight=None, cri...                   11                        60                           1   
5       24.096435         1.828722         0.931312          0.976574  (DecisionTreeClassifier(class_weight=None, cri...                   11                        60                           1   
6       20.806273         2.312870         0.933168          0.978077  (DecisionTreeClassifier(class_weight=None, cri...                   11                        60                           1   
7       19.557909        10.640661         0.928218          0.978872  (DecisionTreeClassifier(class_weight=None, cri...                   11                        60                           1   
8       19.388190        11.843997         0.927599          0.980198  (DecisionTreeClassifier(class_weight=None, cri...                   11                        60                           1   
9       20.490618        12.762710         0.928837          0.980817  (DecisionTreeClassifier(class_weight=None, cri...                   11                        60                           1   
10      17.137284         1.481767         0.930693          0.981171  (DecisionTreeClassifier(class_weight=None, cri...                   11                        70                           1   
11      16.793339         1.691873         0.935025          0.981790  (DecisionTreeClassifier(class_weight=None, cri...                   11                        70                           1   
12      17.310309         7.037817         0.928837          0.979756  (DecisionTreeClassifier(class_weight=None, cri...                   11                        70                           1   
13      17.903682         7.753050         0.927599          0.980198  (DecisionTreeClassifier(class_weight=None, cri...                   11                        70                           1   
14      19.228114         8.171985         0.929455          0.980110  (DecisionTreeClassifier(class_weight=None, cri...                   11                        70                           1   
15      20.533619         1.753055         0.931931          0.981348  (DecisionTreeClassifier(class_weight=None, cri...                   11                        70                           1   
16      20.904532         2.257006         0.935644          0.981790  (DecisionTreeClassifier(class_weight=None, cri...                   11                        70                           1   
17      19.894207        10.378848         0.928218          0.979933  (DecisionTreeClassifier(class_weight=None, cri...                   11                        70                           1   
18      20.386872        12.038835         0.927599          0.980463  (DecisionTreeClassifier(class_weight=None, cri...                   11                        70                           1   
19      20.886330        12.768346         0.928837          0.980994  (DecisionTreeClassifier(class_weight=None, cri...                   11                        70                           1   
20      18.717446         1.322084         0.929455          0.986386  (DecisionTreeClassifier(class_weight=None, cri...                   11                      None                           1   
21      17.427841         1.696458         0.934406          0.986209  (DecisionTreeClassifier(class_weight=None, cri...                   11                      None                           1   
22      17.850463         7.002001         0.926980          0.977192  (DecisionTreeClassifier(class_weight=None, cri...                   11                      None                           1   
23      18.164802         7.691954         0.927599          0.977989  (DecisionTreeClassifier(class_weight=None, cri...                   11                      None                           1   
24      18.228458         8.101216         0.931931          0.978696  (DecisionTreeClassifier(class_weight=None, cri...                   11                      None                           1   
25      26.749637         2.023144         0.931312          0.986651  (DecisionTreeClassifier(class_weight=None, cri...                   11                      None                           1   
26      22.485861         2.088647         0.932550          0.986033  (DecisionTreeClassifier(class_weight=None, cri...                   11                      None                           1   
27      22.751874        10.965924         0.926980          0.977723  (DecisionTreeClassifier(class_weight=None, cri...                   11                      None                           1   
28      26.794656        11.597884         0.930693          0.978519  (DecisionTreeClassifier(class_weight=None, cri...                   11                      None                           1   
29      21.732905        12.372521         0.930693          0.979314  (DecisionTreeClassifier(class_weight=None, cri...                   11                      None                           1   

   param_clf__min_samples_split param_clf__n_estimators param_select__k  rank_test_score  split0_test_score  split0_train_score  split1_test_score  split1_train_score  split2_test_score  \
0                             3                    1100            6000                7           0.921182            0.979476           0.926108            0.978061           0.970443   
1                             3                    1100           10000                5           0.916256            0.980892           0.926108            0.976645           0.970443   
2                             3                    1100          300000               18           0.931034            0.980184           0.906404            0.980184           0.975369   
3                             3                    1100          411500               28           0.935961            0.981599           0.911330            0.980892           0.975369   
4                             3                    1100          455500               15           0.926108            0.982307           0.911330            0.980892           0.975369   
5                             3                    1600            6000               10           0.916256            0.978769           0.926108            0.978061           0.970443   
6                             3                    1600           10000                4           0.921182            0.980184           0.926108            0.979476           0.970443   
7                             3                    1600          300000               22           0.926108            0.980184           0.911330            0.980184           0.975369   
8                             3                    1600          411500               24           0.931034            0.982307           0.916256            0.981599           0.975369   
9                             3                    1600          455500               18           0.935961            0.981599           0.911330            0.983015           0.975369   
10                            3                    1100            6000               12           0.916256            0.983723           0.926108            0.982307           0.965517   
11                            3                    1100           10000                2           0.916256            0.983723           0.935961            0.980892           0.970443   
12                            3                    1100          300000               18           0.931034            0.981599           0.906404            0.980892           0.975369   
13                            3                    1100          411500               24           0.940887            0.982307           0.911330            0.980892           0.975369   
14                            3                    1100          455500               15           0.926108            0.983015           0.911330            0.980892           0.975369   
15                            3                    1600            6000                7           0.916256            0.984430           0.926108            0.982307           0.970443   
16                            3                    1600           10000                1           0.921182            0.983015           0.935961            0.981599           0.970443   
17                            3                    1600          300000               22           0.926108            0.980184           0.911330            0.981599           0.975369   
18                            3                    1600          411500               24           0.931034            0.982307           0.916256            0.982307           0.975369   
19                            3                    1600          455500               18           0.935961            0.981599           0.911330            0.983015           0.975369   
20                            3                    1100            6000               15           0.911330            0.987261           0.921182            0.987261           0.965517   
21                            3                    1100           10000                3           0.916256            0.987261           0.926108            0.985846           0.965517   
22                            3                    1100          300000               28           0.926108            0.975230           0.911330            0.978061           0.975369   
23                            3                    1100          411500               24           0.935961            0.978061           0.906404            0.980892           0.980296   
24                            3                    1100          455500                7           0.935961            0.980184           0.916256            0.981599           0.975369   
25                            3                    1600            6000               10           0.916256            0.987969           0.926108            0.987261           0.970443   
26                            3                    1600           10000                5           0.911330            0.987261           0.921182            0.985846           0.970443   
27                            3                    1600          300000               28           0.926108            0.978769           0.906404            0.978769           0.975369   
28                            3                    1600          411500               12           0.935961            0.979476           0.921182            0.981599           0.975369   
29                            3                    1600          455500               12           0.931034            0.982307           0.911330            0.980184           0.975369   

    split2_train_score  split3_test_score  split3_train_score  split4_test_score  split4_train_score  split5_test_score  split5_train_score  split6_test_score  split6_train_score  split7_test_score  \
0             0.975230           0.925743            0.976662           0.940594            0.973126           0.905473            0.975972           0.915423            0.978799           0.950249   
1             0.980184           0.930693            0.978784           0.945545            0.974540           0.910448            0.975265           0.920398            0.980212           0.940299   
2             0.977353           0.910891            0.979491           0.935644            0.975955           0.900498            0.977385           0.930348            0.981625           0.940299   
3             0.978769           0.910891            0.981612           0.930693            0.976662           0.900498            0.980212           0.930348            0.980212           0.920398   
4             0.978769           0.925743            0.981612           0.945545            0.978076           0.900498            0.976678           0.920398            0.982332           0.930348   
5             0.974522           0.925743            0.975955           0.945545            0.973833           0.905473            0.977385           0.915423            0.978092           0.945274   
6             0.980184           0.930693            0.978784           0.940594            0.973833           0.910448            0.975972           0.920398            0.980212           0.945274   
7             0.977353           0.910891            0.981612           0.935644            0.976662           0.900498            0.975972           0.935323            0.982332           0.930348   
8             0.978061           0.915842            0.980198           0.930693            0.978784           0.905473            0.980212           0.915423            0.982332           0.930348   
9             0.979476           0.920792            0.980198           0.940594            0.978784           0.895522            0.979505           0.920398            0.985159           0.930348   
10            0.981599           0.920792            0.982320           0.945545            0.979491           0.905473            0.979505           0.915423            0.980919           0.950249   
11            0.983723           0.930693            0.983734           0.945545            0.978784           0.915423            0.979505           0.925373            0.984452           0.940299   
12            0.977353           0.910891            0.980198           0.935644            0.976662           0.900498            0.977385           0.930348            0.982332           0.940299   
13            0.978769           0.910891            0.982320           0.930693            0.978076           0.900498            0.980212           0.930348            0.980212           0.920398   
14            0.978769           0.925743            0.981612           0.945545            0.978076           0.900498            0.977385           0.920398            0.982332           0.930348   
15            0.981599           0.925743            0.982320           0.940594            0.979491           0.905473            0.980212           0.920398            0.980212           0.950249   
16            0.983723           0.930693            0.984441           0.940594            0.978076           0.915423            0.979505           0.925373            0.984452           0.945274   
17            0.978061           0.910891            0.981612           0.935644            0.977369           0.900498            0.976678           0.935323            0.983039           0.930348   
18            0.978061           0.915842            0.980905           0.930693            0.978784           0.905473            0.980212           0.915423            0.983039           0.930348   
19            0.979476           0.920792            0.980905           0.940594            0.979491           0.895522            0.979505           0.920398            0.985159           0.930348   
20            0.986553           0.925743            0.985856           0.935644            0.985149           0.905473            0.985866           0.925373            0.987279           0.945274   
21            0.986553           0.925743            0.985856           0.945545            0.985149           0.920398            0.985866           0.930348            0.987986           0.945274   
22            0.975230           0.915842            0.979491           0.935644            0.975248           0.905473            0.978092           0.920398            0.978799           0.925373   
23            0.979476           0.915842            0.977369           0.950495            0.978784           0.895522            0.975972           0.910448            0.977385           0.925373   
24            0.978769           0.920792            0.975955           0.940594            0.978076           0.900498            0.978092           0.925373            0.979505           0.940299   
25            0.985846           0.925743            0.987270           0.935644            0.985149           0.905473            0.986572           0.925373            0.987279           0.945274   
26            0.987261           0.925743            0.985149           0.940594            0.985149           0.920398            0.985159           0.930348            0.987279           0.940299   
27            0.976645           0.915842            0.980198           0.940594            0.977369           0.900498            0.976678           0.920398            0.977385           0.930348   
28            0.978769           0.905941            0.976662           0.950495            0.979491           0.900498            0.976678           0.915423            0.979505           0.940299   
29            0.977353           0.920792            0.980198           0.940594            0.976662           0.900498            0.979505           0.925373            0.981625           0.940299   

    split7_train_score  std_fit_time  std_score_time  std_test_score  std_train_score  
0             0.975972      0.772393        0.161760        0.019544         0.001935  
1             0.975972      0.326478        0.159891        0.018085         0.002339  
2             0.980212      0.626329        0.312172        0.022325         0.001802  
3             0.978799      1.724508        0.477700        0.021521         0.001579  
4             0.978092      1.578638        1.025081        0.021358         0.002057  
5             0.975972      1.665772        0.173837        0.019802         0.001675  
6             0.975972      0.832708        0.280805        0.017585         0.002312  
7             0.976678      0.812670        0.648216        0.021506         0.002328  
8             0.978092      0.616159        0.476424        0.020076         0.001657  
9             0.978799      1.054971        0.447199        0.022123         0.002133  
10            0.979505      0.584851        0.167755        0.019408         0.001489  
11            0.979505      0.486013        0.194226        0.016762         0.002197  
12            0.981625      0.746354        0.747278        0.022325         0.002121  
13            0.978799      0.853073        0.756480        0.021839         0.001497  
14            0.978799      0.916266        1.517900        0.021358         0.001979  
15            0.980212      1.870606        0.197762        0.019518         0.001531  
16            0.979505      0.893980        0.297059        0.016126         0.002335  
17            0.980919      0.827838        0.454024        0.021506         0.002149  
18            0.978092      1.049394        0.627748        0.020076         0.001868  
19            0.978799      1.133595        0.761777        0.022123         0.002043  
20            0.985866      1.833817        0.069578        0.018013         0.000767  
21            0.985159      0.653137        0.196084        0.015416         0.000934  
22            0.977385      0.882697        0.777073        0.020326         0.001618  
23            0.975972      1.309724        0.723639        0.025730         0.001588  
24            0.977385      1.780422        0.675134        0.020779         0.001631  
25            0.985866      1.750912        0.457388        0.018497         0.000896  
26            0.985159      1.163812        0.165541        0.017132         0.000981  
27            0.975972      2.173282        1.911626        0.021912         0.001317  
28            0.975972      2.794603        0.564915        0.023347         0.001793  
29            0.976678      1.107145        0.996338        0.021231         0.002052  
Search results saved as search_results.csv
2017-07-05 08:56:14,287 DEBUG randomized search done in 1:14:19.557177
2017-07-05 08:56:14,976 INFO Evaluating the selected model on the test set...
2017-07-05 08:56:14,976 DEBUG Generating feature vector...
Vector union has 1485775 features.
2017-07-05 08:56:33,977 INFO Generated vector of 6 features in 0:00:19.001271 from 2155 samples.
2017-07-05 08:56:37,462 DEBUG Fitted 1616 data points.
2017-07-05 08:56:37,462 DEBUG Fitting done in 0:00:22.485864
2017-07-05 08:56:37,462 DEBUG Generating feature vector...
Vector union has 1485775 features.
2017-07-05 08:56:47,084 INFO Generated vector of 6 features in 0:00:09.621553 from 2155 samples.
Evaluation report:
             precision    recall  f1-score   support

     cancer       0.89      0.98      0.93       271
  nonCancer       0.98      0.88      0.93       268

avg / total       0.94      0.93      0.93       539

Accuracy: 0.9313543599257885
2017-07-05 08:56:48,090 DEBUG Evaluation done in 0:00:00.998385
2017-07-05 08:56:48,094 INFO Building the selected model on the whole data set...
Hyper parameters:
{'clf__bootstrap': True,
 'clf__class_weight': None,
 'clf__criterion': 'gini',
 'clf__max_depth': 11,
 'clf__max_features': 'log2',
 'clf__max_leaf_nodes': 70,
 'clf__min_impurity_split': 1e-05,
 'clf__min_samples_leaf': 1,
 'clf__min_samples_split': 3,
 'clf__min_weight_fraction_leaf': 0.0,
 'clf__n_estimators': 1600,
 'clf__n_jobs': -1,
 'clf__oob_score': False,
 'clf__random_state': <mtrand.RandomState object at 0x7f693d4a2fc0>,
 'clf__verbose': 0,
 'clf__warm_start': False,
 'select': SelectKBest(k=10000, score_func=<function chi2 at 0x7f694637c2f0>),
 'select__k': 10000,
 'select__score_func': <function chi2 at 0x7f694637c2f0>}
2017-07-05 08:56:48,096 DEBUG Generating feature vector...
Vector union has 1863572 features.
2017-07-05 08:57:58,213 INFO Generated vector of 1863572 features in 0:01:10.113562 from 2155 samples.
2017-07-05 08:58:02,268 DEBUG Fitted 2155 data points.
2017-07-05 08:58:02,269 DEBUG Fitting done in 0:00:04.052127
Model saved as model_2017-07-05--08-56-48.pkl

