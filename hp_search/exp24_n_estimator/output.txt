python3 main.py --train ../wbi_binary/pre2_train.csv --score --hp randomized --oob
2017-06-30 18:45:37,986 DEBUG Commandline arguments: Namespace(hp='randomized', hp_metric='accuracy', model=None, oob=True, predict=None, score=True, test_size=0.25, train=<_io.TextIOWrapper name='../wbi_binary/pre2_train.csv' mode='r' encoding='UTF-8'>)
2017-06-30 18:45:37,986 DEBUG Valid mode of operation
2017-06-30 18:45:37,986 INFO Mode score->train
2017-06-30 18:45:37,987 DEBUG Loading data...
2017-06-30 18:45:38,072 INFO Created training set (1616) and test set (539)
2017-06-30 18:45:38,072 INFO Recognised data-set: binary
2017-06-30 18:45:38,073 INFO Using randomized search on the training set to select the best model (hyper-parameters)...
2017-06-30 18:45:38,073 DEBUG Performing randomized search, optimizing accuracy score...
2017-06-30 18:45:38,074 DEBUG Generating feature vector...
Vector union has 1485775 features.
2017-06-30 18:45:57,915 INFO Generated vector of 1485775 features in 0:00:19.841167 from 1616 samples.
Fitting 2 folds for each of 1 candidates, totalling 2 fits
[Parallel(n_jobs=-1)]: Done   2 out of   2 | elapsed:  1.4min finished
Hyper parameter search report:
Parameter search space:
{'clf': [ExtraTreesClassifier(bootstrap=False, class_weight=None, criterion='gini',
           max_depth=None, max_features='log2', max_leaf_nodes=None,
           min_impurity_split=1e-05, min_samples_leaf=1,
           min_samples_split=2, min_weight_fraction_leaf=0.0,
           n_estimators=10, n_jobs=-1, oob_score=False,
           random_state=<mtrand.RandomState object at 0x7efbd9b35ee8>,
           verbose=0, warm_start=False)],
 'clf__max_depth': [12],
 'clf__max_leaf_nodes': [35],
 'clf__min_samples_leaf': [3],
 'clf__min_samples_split': [5],
 'clf__n_estimators': [1500],
 'select__k': [411500]}
Best score: 0.939
Best parameters set:
{'clf__max_depth': 12,
 'clf__max_leaf_nodes': 35,
 'clf__min_samples_leaf': 3,
 'clf__min_samples_split': 5,
 'clf__n_estimators': 1500,
 'select__k': 411500}
Detailed folds results:
   mean_fit_time  mean_score_time  mean_test_score  mean_train_score                                          param_clf param_clf__max_depth param_clf__max_leaf_nodes param_clf__min_samples_leaf  \
0      37.076758        19.168564         0.939356          0.975869  (ExtraTreeClassifier(class_weight=None, criter...                   12                        35                           3   

  param_clf__min_samples_split param_clf__n_estimators param_select__k  rank_test_score  split0_test_score  split0_train_score  split1_test_score  split1_train_score  std_fit_time  std_score_time  \
0                            5                    1500          411500                1            0.94932            0.977695           0.929368            0.974042      0.990989        0.462739   

   std_test_score  std_train_score  
0        0.009976         0.001827  
Search results saved as search_results.csv
2017-06-30 18:47:23,063 DEBUG randomized search done in 0:01:24.984126
2017-06-30 18:47:23,213 INFO Evaluating the selected model on the test set...
2017-06-30 18:47:23,213 DEBUG Generating feature vector...
Vector union has 1485775 features.
2017-06-30 18:47:43,975 INFO Generated vector of 6 features in 0:00:20.761881 from 2155 samples.
2017-06-30 18:47:43,977 DEBUG Calculating out-of-bag error over tree count (range 25-1500)...
2017-06-30 18:47:57,102 DEBUG Out-of-bag error for 30 trees = 0.25742574257425743
2017-06-30 18:48:25,024 DEBUG Out-of-bag error for 40 trees = 0.22524752475247523
2017-06-30 18:48:53,627 DEBUG Out-of-bag error for 50 trees = 0.1757425742574258
2017-06-30 18:49:31,659 DEBUG Out-of-bag error for 60 trees = 0.17017326732673266
2017-06-30 18:50:09,290 DEBUG Out-of-bag error for 70 trees = 0.1652227722772277
2017-06-30 18:50:46,947 DEBUG Out-of-bag error for 80 trees = 0.14975247524752477
2017-06-30 18:51:29,787 DEBUG Out-of-bag error for 90 trees = 0.15037128712871284
2017-06-30 18:52:16,372 DEBUG Out-of-bag error for 100 trees = 0.1367574257425742
2017-06-30 18:53:05,297 DEBUG Out-of-bag error for 110 trees = 0.13366336633663367
2017-06-30 18:53:54,716 DEBUG Out-of-bag error for 120 trees = 0.12190594059405946
2017-06-30 18:54:49,251 DEBUG Out-of-bag error for 130 trees = 0.11819306930693074
2017-06-30 18:55:51,076 DEBUG Out-of-bag error for 140 trees = 0.11571782178217827
2017-06-30 18:56:55,673 DEBUG Out-of-bag error for 150 trees = 0.11262376237623761
2017-06-30 18:57:59,633 DEBUG Out-of-bag error for 160 trees = 0.10767326732673266
2017-06-30 18:59:11,196 DEBUG Out-of-bag error for 170 trees = 0.09777227722772275
2017-06-30 19:00:18,413 DEBUG Out-of-bag error for 180 trees = 0.0946782178217822
2017-06-30 19:01:32,980 DEBUG Out-of-bag error for 190 trees = 0.0928217821782178
2017-06-30 19:02:57,005 DEBUG Out-of-bag error for 200 trees = 0.09220297029702973
2017-06-30 19:04:09,711 DEBUG Out-of-bag error for 210 trees = 0.09158415841584155
2017-06-30 19:05:27,094 DEBUG Out-of-bag error for 220 trees = 0.09405940594059403
2017-06-30 19:06:47,526 DEBUG Out-of-bag error for 230 trees = 0.09096534653465349
2017-06-30 19:08:19,585 DEBUG Out-of-bag error for 240 trees = 0.09034653465346532
2017-06-30 19:09:48,443 DEBUG Out-of-bag error for 250 trees = 0.08725247524752477
2017-06-30 19:11:17,118 DEBUG Out-of-bag error for 260 trees = 0.09158415841584155
2017-06-30 19:13:03,171 DEBUG Out-of-bag error for 270 trees = 0.08972772277227725
2017-06-30 19:15:02,875 DEBUG Out-of-bag error for 280 trees = 0.08601485148514854
2017-06-30 19:16:57,856 DEBUG Out-of-bag error for 290 trees = 0.08849009900990101
2017-06-30 19:18:47,778 DEBUG Out-of-bag error for 300 trees = 0.08725247524752477
2017-06-30 19:20:28,789 DEBUG Out-of-bag error for 310 trees = 0.08292079207920788
2017-06-30 19:22:07,412 DEBUG Out-of-bag error for 320 trees = 0.07920792079207917
2017-06-30 19:24:03,475 DEBUG Out-of-bag error for 330 trees = 0.07982673267326734
2017-06-30 19:26:10,289 DEBUG Out-of-bag error for 340 trees = 0.08106435643564358
2017-06-30 19:28:18,155 DEBUG Out-of-bag error for 350 trees = 0.08168316831683164
2017-06-30 19:30:31,435 DEBUG Out-of-bag error for 360 trees = 0.0804455445544554
2017-06-30 19:32:44,757 DEBUG Out-of-bag error for 370 trees = 0.08230198019801982
2017-06-30 19:34:52,441 DEBUG Out-of-bag error for 380 trees = 0.08168316831683164
2017-06-30 19:37:27,659 DEBUG Out-of-bag error for 390 trees = 0.0804455445544554
2017-06-30 19:40:07,994 DEBUG Out-of-bag error for 400 trees = 0.07673267326732669
2017-06-30 19:42:21,939 DEBUG Out-of-bag error for 410 trees = 0.07920792079207917
2017-06-30 19:44:40,891 DEBUG Out-of-bag error for 420 trees = 0.07673267326732669
2017-06-30 19:47:03,174 DEBUG Out-of-bag error for 430 trees = 0.07797029702970293
2017-06-30 19:49:15,555 DEBUG Out-of-bag error for 440 trees = 0.07425742574257421
2017-06-30 19:51:40,699 DEBUG Out-of-bag error for 450 trees = 0.07363861386138615
2017-06-30 19:54:02,204 DEBUG Out-of-bag error for 460 trees = 0.07425742574257421
2017-06-30 19:56:30,216 DEBUG Out-of-bag error for 470 trees = 0.06992574257425743
2017-06-30 19:58:53,141 DEBUG Out-of-bag error for 480 trees = 0.0686881188118812
2017-06-30 20:01:17,428 DEBUG Out-of-bag error for 490 trees = 0.06806930693069302
2017-06-30 20:03:46,393 DEBUG Out-of-bag error for 500 trees = 0.06930693069306926
2017-06-30 20:06:16,301 DEBUG Out-of-bag error for 510 trees = 0.06621287128712872
2017-06-30 20:08:47,165 DEBUG Out-of-bag error for 520 trees = 0.0643564356435643
2017-06-30 20:11:21,427 DEBUG Out-of-bag error for 530 trees = 0.061881188118811936
2017-06-30 20:13:57,686 DEBUG Out-of-bag error for 540 trees = 0.06311881188118806
2017-06-30 20:16:37,469 DEBUG Out-of-bag error for 550 trees = 0.06126237623762376
2017-06-30 20:19:20,715 DEBUG Out-of-bag error for 560 trees = 0.06311881188118806
2017-06-30 20:22:08,881 DEBUG Out-of-bag error for 570 trees = 0.0643564356435643
2017-06-30 20:24:57,683 DEBUG Out-of-bag error for 580 trees = 0.0625
2017-06-30 20:27:47,016 DEBUG Out-of-bag error for 590 trees = 0.0643564356435643
2017-06-30 20:30:41,872 DEBUG Out-of-bag error for 600 trees = 0.06311881188118806
2017-06-30 20:33:48,318 DEBUG Out-of-bag error for 610 trees = 0.06497524752475248
2017-06-30 20:37:14,027 DEBUG Out-of-bag error for 620 trees = 0.06311881188118806
2017-06-30 20:40:46,133 DEBUG Out-of-bag error for 630 trees = 0.06126237623762376
2017-06-30 20:44:13,918 DEBUG Out-of-bag error for 640 trees = 0.061881188118811936
2017-06-30 20:47:37,128 DEBUG Out-of-bag error for 650 trees = 0.06311881188118806
2017-06-30 20:51:14,821 DEBUG Out-of-bag error for 660 trees = 0.0643564356435643
2017-06-30 20:54:59,049 DEBUG Out-of-bag error for 670 trees = 0.06497524752475248
2017-06-30 20:59:02,193 DEBUG Out-of-bag error for 680 trees = 0.06311881188118806
2017-06-30 21:02:21,905 DEBUG Out-of-bag error for 690 trees = 0.06373762376237624
2017-06-30 21:06:13,923 DEBUG Out-of-bag error for 700 trees = 0.06373762376237624
2017-06-30 21:10:22,892 DEBUG Out-of-bag error for 710 trees = 0.06373762376237624
2017-06-30 21:14:36,758 DEBUG Out-of-bag error for 720 trees = 0.06373762376237624
2017-06-30 21:18:51,177 DEBUG Out-of-bag error for 730 trees = 0.06311881188118806
2017-06-30 21:23:25,678 DEBUG Out-of-bag error for 740 trees = 0.061881188118811936
2017-06-30 21:27:54,478 DEBUG Out-of-bag error for 750 trees = 0.0625
2017-06-30 21:31:36,709 DEBUG Out-of-bag error for 760 trees = 0.061881188118811936
2017-06-30 21:36:48,068 DEBUG Out-of-bag error for 770 trees = 0.06002475247524752
2017-06-30 21:41:42,551 DEBUG Out-of-bag error for 780 trees = 0.06373762376237624
2017-06-30 21:46:04,767 DEBUG Out-of-bag error for 790 trees = 0.0625
2017-06-30 21:50:25,441 DEBUG Out-of-bag error for 800 trees = 0.06373762376237624
2017-06-30 21:54:41,333 DEBUG Out-of-bag error for 810 trees = 0.0625
2017-06-30 21:58:55,407 DEBUG Out-of-bag error for 820 trees = 0.0625
2017-06-30 22:03:21,098 DEBUG Out-of-bag error for 830 trees = 0.06002475247524752
2017-06-30 22:07:50,175 DEBUG Out-of-bag error for 840 trees = 0.06002475247524752
2017-06-30 22:11:51,659 DEBUG Out-of-bag error for 850 trees = 0.0625
2017-06-30 22:15:53,199 DEBUG Out-of-bag error for 860 trees = 0.06311881188118806
2017-06-30 22:20:00,984 DEBUG Out-of-bag error for 870 trees = 0.06497524752475248
2017-06-30 22:24:05,939 DEBUG Out-of-bag error for 880 trees = 0.06311881188118806
2017-06-30 22:28:13,945 DEBUG Out-of-bag error for 890 trees = 0.061881188118811936
2017-06-30 22:32:24,476 DEBUG Out-of-bag error for 900 trees = 0.06373762376237624
2017-06-30 22:36:36,501 DEBUG Out-of-bag error for 910 trees = 0.06373762376237624
2017-06-30 22:40:51,570 DEBUG Out-of-bag error for 920 trees = 0.061881188118811936
2017-06-30 22:45:09,271 DEBUG Out-of-bag error for 930 trees = 0.05940594059405946
2017-06-30 22:49:29,174 DEBUG Out-of-bag error for 940 trees = 0.06002475247524752
2017-06-30 22:53:55,924 DEBUG Out-of-bag error for 950 trees = 0.05940594059405946
2017-06-30 22:58:20,925 DEBUG Out-of-bag error for 960 trees = 0.05940594059405946
2017-06-30 23:02:48,851 DEBUG Out-of-bag error for 970 trees = 0.0606435643564357
2017-06-30 23:07:20,062 DEBUG Out-of-bag error for 980 trees = 0.0606435643564357
2017-06-30 23:11:52,770 DEBUG Out-of-bag error for 990 trees = 0.05940594059405946
2017-06-30 23:16:28,226 DEBUG Out-of-bag error for 1000 trees = 0.058787128712871284
2017-06-30 23:21:07,265 DEBUG Out-of-bag error for 1010 trees = 0.056311881188118806
2017-06-30 23:25:49,110 DEBUG Out-of-bag error for 1020 trees = 0.05816831683168322
2017-06-30 23:30:32,825 DEBUG Out-of-bag error for 1030 trees = 0.057549504950495045
2017-06-30 23:35:19,022 DEBUG Out-of-bag error for 1040 trees = 0.058787128712871284
2017-06-30 23:40:09,264 DEBUG Out-of-bag error for 1050 trees = 0.05940594059405946
2017-06-30 23:45:03,090 DEBUG Out-of-bag error for 1060 trees = 0.057549504950495045
2017-06-30 23:49:58,161 DEBUG Out-of-bag error for 1070 trees = 0.05816831683168322
2017-06-30 23:54:55,358 DEBUG Out-of-bag error for 1080 trees = 0.05940594059405946
2017-06-30 23:59:55,239 DEBUG Out-of-bag error for 1090 trees = 0.057549504950495045
2017-07-01 00:04:57,960 DEBUG Out-of-bag error for 1100 trees = 0.05693069306930698
2017-07-01 00:10:04,522 DEBUG Out-of-bag error for 1110 trees = 0.057549504950495045
2017-07-01 00:15:12,413 DEBUG Out-of-bag error for 1120 trees = 0.057549504950495045
2017-07-01 00:20:24,444 DEBUG Out-of-bag error for 1130 trees = 0.05693069306930698
2017-07-01 00:25:39,146 DEBUG Out-of-bag error for 1140 trees = 0.057549504950495045
2017-07-01 00:30:56,015 DEBUG Out-of-bag error for 1150 trees = 0.057549504950495045
2017-07-01 00:36:14,351 DEBUG Out-of-bag error for 1160 trees = 0.057549504950495045
2017-07-01 00:41:35,151 DEBUG Out-of-bag error for 1170 trees = 0.058787128712871284
2017-07-01 00:46:59,293 DEBUG Out-of-bag error for 1180 trees = 0.05940594059405946
2017-07-01 00:52:25,341 DEBUG Out-of-bag error for 1190 trees = 0.057549504950495045
2017-07-01 00:57:54,057 DEBUG Out-of-bag error for 1200 trees = 0.058787128712871284
2017-07-01 01:03:25,196 DEBUG Out-of-bag error for 1210 trees = 0.05816831683168322
2017-07-01 01:09:01,123 DEBUG Out-of-bag error for 1220 trees = 0.05693069306930698
2017-07-01 01:14:38,059 DEBUG Out-of-bag error for 1230 trees = 0.057549504950495045
2017-07-01 01:20:18,077 DEBUG Out-of-bag error for 1240 trees = 0.05940594059405946
2017-07-01 01:26:00,279 DEBUG Out-of-bag error for 1250 trees = 0.058787128712871284
2017-07-01 01:31:47,390 DEBUG Out-of-bag error for 1260 trees = 0.057549504950495045
2017-07-01 01:37:34,500 DEBUG Out-of-bag error for 1270 trees = 0.058787128712871284
2017-07-01 01:43:24,504 DEBUG Out-of-bag error for 1280 trees = 0.05693069306930698
2017-07-01 01:49:17,062 DEBUG Out-of-bag error for 1290 trees = 0.05693069306930698
2017-07-01 01:55:12,398 DEBUG Out-of-bag error for 1300 trees = 0.056311881188118806
2017-07-01 02:01:10,198 DEBUG Out-of-bag error for 1310 trees = 0.057549504950495045
2017-07-01 02:07:10,644 DEBUG Out-of-bag error for 1320 trees = 0.056311881188118806
2017-07-01 02:13:13,396 DEBUG Out-of-bag error for 1330 trees = 0.05693069306930698
2017-07-01 02:19:18,650 DEBUG Out-of-bag error for 1340 trees = 0.057549504950495045
2017-07-01 02:25:26,591 DEBUG Out-of-bag error for 1350 trees = 0.057549504950495045
2017-07-01 02:31:37,716 DEBUG Out-of-bag error for 1360 trees = 0.056311881188118806
2017-07-01 02:37:50,712 DEBUG Out-of-bag error for 1370 trees = 0.05816831683168322
2017-07-01 02:44:07,165 DEBUG Out-of-bag error for 1380 trees = 0.058787128712871284
2017-07-01 02:50:26,087 DEBUG Out-of-bag error for 1390 trees = 0.058787128712871284
2017-07-01 02:56:48,937 DEBUG Out-of-bag error for 1400 trees = 0.05816831683168322
2017-07-01 03:03:13,390 DEBUG Out-of-bag error for 1410 trees = 0.05693069306930698
2017-07-01 03:09:43,121 DEBUG Out-of-bag error for 1420 trees = 0.057549504950495045
2017-07-01 03:16:13,326 DEBUG Out-of-bag error for 1430 trees = 0.056311881188118806
2017-07-01 03:22:45,985 DEBUG Out-of-bag error for 1440 trees = 0.058787128712871284
2017-07-01 03:29:22,068 DEBUG Out-of-bag error for 1450 trees = 0.058787128712871284
2017-07-01 03:35:59,794 DEBUG Out-of-bag error for 1460 trees = 0.05816831683168322
2017-07-01 03:42:40,937 DEBUG Out-of-bag error for 1470 trees = 0.05940594059405946
2017-07-01 03:49:24,037 DEBUG Out-of-bag error for 1480 trees = 0.0606435643564357
2017-07-01 03:56:09,734 DEBUG Out-of-bag error for 1490 trees = 0.058787128712871284
2017-07-01 04:02:58,550 DEBUG Out-of-bag error for 1500 trees = 0.05940594059405946
OOB error saved as oob.csv
2017-07-01 04:02:58,665 DEBUG Fitted 1616 data points.
2017-07-01 04:02:58,665 DEBUG Fitting and oob calculation done in 9:15:35.344184
2017-07-01 04:02:58,788 DEBUG Generating feature vector...
Vector union has 1485775 features.
2017-07-01 04:03:08,046 INFO Generated vector of 6 features in 0:00:09.257903 from 2155 samples.
Evaluation report:
             precision    recall  f1-score   support

     cancer       0.90      0.97      0.93       271
  nonCancer       0.97      0.89      0.93       268

avg / total       0.93      0.93      0.93       539

Accuracy: 0.9313543599257885
2017-07-01 04:03:14,751 DEBUG Evaluation done in 0:00:06.701701
2017-07-01 04:03:14,761 INFO Building the selected model on the whole data set...
Hyper parameters:
{'clf__bootstrap': False,
 'clf__class_weight': None,
 'clf__criterion': 'gini',
 'clf__max_depth': 12,
 'clf__max_features': 'log2',
 'clf__max_leaf_nodes': 35,
 'clf__min_impurity_split': 1e-05,
 'clf__min_samples_leaf': 3,
 'clf__min_samples_split': 5,
 'clf__min_weight_fraction_leaf': 0.0,
 'clf__n_estimators': 1500,
 'clf__n_jobs': -1,
 'clf__oob_score': False,
 'clf__random_state': <mtrand.RandomState object at 0x7efbc6a5df30>,
 'clf__verbose': 0,
 'clf__warm_start': False,
 'select': SelectKBest(k=411500, score_func=<function chi2 at 0x7efbe0b302f0>),
 'select__k': 411500,
 'select__score_func': <function chi2 at 0x7efbe0b302f0>}
2017-07-01 04:03:14,762 DEBUG Generating feature vector...
Vector union has 1863572 features.
2017-07-01 04:03:44,986 INFO Generated vector of 1863572 features in 0:00:30.222982 from 2155 samples.
2017-07-01 04:03:48,903 DEBUG Fitted 2155 data points.
2017-07-01 04:03:48,903 DEBUG Fitting done in 0:00:03.917467
Model saved as model_2017-07-01--04-03-14.pkl
