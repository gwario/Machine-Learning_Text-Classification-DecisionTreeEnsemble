python3 main.py --train ../wbi_binary/pre2_train.csv --score --hp randomized 
2017-07-01 22:26:38,627 DEBUG Commandline arguments: Namespace(hp='randomized', hp_metric='accuracy', model=None, oob=False, predict=None, score=True, test_size=0.25, train=<_io.TextIOWrapper name='../wbi_binary/pre2_train.csv' mode='r' encoding='UTF-8'>)
2017-07-01 22:26:38,627 DEBUG Valid mode of operation
2017-07-01 22:26:38,627 INFO Mode score->train
2017-07-01 22:26:38,627 DEBUG Loading data...
2017-07-01 22:26:38,720 INFO Created training set (1616) and test set (539)
2017-07-01 22:26:38,720 INFO Recognised data-set: binary
2017-07-01 22:26:38,721 INFO Using randomized search on the training set to select the best model (hyper-parameters)...
2017-07-01 22:26:38,721 DEBUG Performing randomized search, optimizing accuracy score...
2017-07-01 22:26:38,722 DEBUG Generating feature vector...
Vector union has 1485775 features.
2017-07-01 22:26:59,840 INFO Generated vector of 1485775 features in 0:00:21.117086 from 1616 samples.
Fitting 3 folds for each of 20 candidates, totalling 60 fits
[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed: 404.9min
[Parallel(n_jobs=-1)]: Done  60 out of  60 | elapsed: 593.9min finished
Hyper parameter search report:
Parameter search space:
{'clf': [AdaBoostClassifier(algorithm='SAMME.R',
          base_estimator=ExtraTreesClassifier(bootstrap=False, class_weight=None, criterion='gini',
           max_depth=None, max_features='log2', max_leaf_nodes=None,
           min_impurity_split=1e-05, min_samples_leaf=1,
           min_samples_split=2, min_weight_fraction_leaf=0.0,
           n_estimators=10, n_jobs=-1, oob_score=False,
           random_state=<mtrand.RandomState object at 0x7ff310230ee8>,
           verbose=0, warm_start=False),
          learning_rate=1.0, n_estimators=50,
          random_state=<mtrand.RandomState object at 0x7ff310230ee8>)],
 'clf__base_estimator__max_depth': [17],
 'clf__base_estimator__max_leaf_nodes': [35, 40, 45],
 'clf__base_estimator__min_samples_leaf': [1, 4, 5, 6],
 'clf__base_estimator__min_samples_split': [6, 7, 8],
 'clf__base_estimator__n_estimators': [600],
 'select__k': [411500]}
Best score: 0.947
Best parameters set:
{'clf': AdaBoostClassifier(algorithm='SAMME.R',
          base_estimator=ExtraTreesClassifier(bootstrap=False, class_weight=None, criterion='gini',
           max_depth=17, max_features='log2', max_leaf_nodes=40,
           min_impurity_split=1e-05, min_samples_leaf=1,
           min_samples_split=6, min_weight_fraction_leaf=0.0,
           n_estimators=600, n_jobs=-1, oob_score=False,
           random_state=<mtrand.RandomState object at 0x7ff2f4954f30>,
           verbose=0, warm_start=False),
          learning_rate=1.0, n_estimators=50,
          random_state=<mtrand.RandomState object at 0x7ff2f4954f30>),
 'clf__base_estimator__max_depth': 17,
 'clf__base_estimator__max_leaf_nodes': 40,
 'clf__base_estimator__min_samples_leaf': 1,
 'clf__base_estimator__min_samples_split': 6,
 'clf__base_estimator__n_estimators': 600,
 'select__k': 411500}
Detailed folds results:
    mean_fit_time  mean_score_time  mean_test_score  mean_train_score                                          param_clf param_clf__base_estimator__max_depth  \
0      164.759081        42.786396         0.946782          0.997525  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
1     1117.167587       400.901317         0.945545          0.990410  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
2     1431.071349       484.829579         0.940594          0.985770  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
3     1466.041706       494.661046         0.939356          0.975869  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
4     1469.579224       506.907084         0.939356          0.975869  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
5     1440.818559       495.747260         0.940594          0.985770  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
6     1453.682989       481.332043         0.940594          0.985770  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
7     1447.019612       494.708475         0.939356          0.975869  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
8     1190.638889       391.025261         0.945545          0.990410  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
9     1154.786156       385.646365         0.945545          0.990410  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
10    1194.652521       373.162066         0.945545          0.990410  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
11    1455.779002       466.382075         0.940594          0.985770  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
12     225.742385        45.795600         0.944307          0.997834  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
13     237.537048        52.533741         0.944926          0.997834  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
14    1335.359988       485.972679         0.939356          0.975869  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
15    1368.448473       499.645573         0.939356          0.975869  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
16    1409.904584       524.208275         0.939356          0.975869  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
17    1191.239529       435.847080         0.945545          0.990410  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
18    1438.922355       460.348998         0.940594          0.985770  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   
19     254.082598        59.262239         0.945545          0.998144  ((ExtraTreeClassifier(class_weight=None, crite...                                   17   

   param_clf__base_estimator__max_leaf_nodes param_clf__base_estimator__min_samples_leaf param_clf__base_estimator__min_samples_split param_clf__base_estimator__n_estimators param_select__k  \
0                                         40                                           1                                            6                                     600          411500   
1                                         45                                           4                                            8                                     600          411500   
2                                         40                                           5                                            7                                     600          411500   
3                                         35                                           6                                            6                                     600          411500   
4                                         35                                           6                                            8                                     600          411500   
5                                         45                                           5                                            8                                     600          411500   
6                                         35                                           5                                            8                                     600          411500   
7                                         40                                           6                                            7                                     600          411500   
8                                         40                                           4                                            8                                     600          411500   
9                                         35                                           4                                            6                                     600          411500   
10                                        35                                           4                                            8                                     600          411500   
11                                        40                                           5                                            6                                     600          411500   
12                                        45                                           1                                            7                                     600          411500   
13                                        40                                           1                                            7                                     600          411500   
14                                        40                                           6                                            8                                     600          411500   
15                                        40                                           6                                            6                                     600          411500   
16                                        45                                           6                                            6                                     600          411500   
17                                        35                                           4                                            7                                     600          411500   
18                                        35                                           5                                            7                                     600          411500   
19                                        40                                           1                                            8                                     600          411500   

    rank_test_score  split0_test_score  split0_train_score  split1_test_score  split1_train_score  split2_test_score  split2_train_score  std_fit_time  std_score_time  std_test_score  \
0                 1           0.946296            0.997212           0.946097            0.997217           0.947955            0.998145     39.175092       10.026207        0.000833   
1                 2           0.950000            0.993494           0.946097            0.988868           0.940520            0.988868    179.469093       70.487864        0.003891   
2                10           0.942593            0.989777           0.942379            0.986085           0.936803            0.981447     26.652100       14.684544        0.002680   
3                15           0.944444            0.979554           0.938662            0.974954           0.934944            0.973098     13.449104       20.544221        0.003911   
4                15           0.944444            0.979554           0.938662            0.974954           0.934944            0.973098     26.103903       13.445411        0.003911   
5                10           0.942593            0.989777           0.942379            0.986085           0.936803            0.981447     17.253279       17.209421        0.002680   
6                10           0.942593            0.989777           0.942379            0.986085           0.936803            0.981447     53.814747       14.981218        0.002680   
7                15           0.944444            0.979554           0.938662            0.974954           0.934944            0.973098     29.061366       20.766324        0.003911   
8                 2           0.950000            0.993494           0.946097            0.988868           0.940520            0.988868    191.934425       40.149232        0.003891   
9                 2           0.950000            0.993494           0.946097            0.988868           0.940520            0.988868    144.107416       76.380760        0.003891   
10                2           0.950000            0.993494           0.946097            0.988868           0.940520            0.988868    164.908620       36.844877        0.003891   
11               10           0.942593            0.989777           0.942379            0.986085           0.936803            0.981447     17.646190       11.956626        0.002680   
12                9           0.944444            0.998141           0.944238            0.997217           0.944238            0.998145     29.625324       12.867918        0.000097   
13                8           0.944444            0.998141           0.946097            0.997217           0.944238            0.998145      6.585471        3.140996        0.000831   
14               15           0.944444            0.979554           0.938662            0.974954           0.934944            0.973098      8.123994        8.350456        0.003911   
15               15           0.944444            0.979554           0.938662            0.974954           0.934944            0.973098     26.269634       15.571150        0.003911   
16               15           0.944444            0.979554           0.938662            0.974954           0.934944            0.973098     17.744592       14.193805        0.003911   
17                2           0.950000            0.993494           0.946097            0.988868           0.940520            0.988868    190.815906       80.707841        0.003891   
18               10           0.942593            0.989777           0.942379            0.986085           0.936803            0.981447     25.478924       13.234593        0.002680   
19                2           0.950000            0.998141           0.942379            0.997217           0.944238            0.999072     11.102250        4.891927        0.003246   

    std_train_score  
0          0.000439  
1          0.002181  
2          0.003408  
3          0.002714  
4          0.002714  
5          0.003408  
6          0.003408  
7          0.002714  
8          0.002181  
9          0.002181  
10         0.002181  
11         0.003408  
12         0.000436  
13         0.000436  
14         0.002714  
15         0.002714  
16         0.002714  
17         0.002181  
18         0.003408  
19         0.000757  
Search results saved as search_results.csv
2017-07-02 08:24:01,272 DEBUG randomized search done in 9:53:58.732481
2017-07-02 08:24:05,781 INFO Evaluating the selected model on the test set...
2017-07-02 08:24:05,781 DEBUG Generating feature vector...
Vector union has 1485775 features.
2017-07-02 08:27:29,038 INFO Generated vector of 6 features in 0:03:23.252250 from 2155 samples.
2017-07-02 08:29:01,800 DEBUG Fitted 1616 data points.
2017-07-02 08:29:01,800 DEBUG Fitting done in 0:04:56.017136
2017-07-02 08:29:01,800 DEBUG Generating feature vector...
Vector union has 1485775 features.
2017-07-02 08:29:14,097 INFO Generated vector of 6 features in 0:00:12.296773 from 2155 samples.
Evaluation report:
             precision    recall  f1-score   support

     cancer       0.92      0.98      0.95       271
  nonCancer       0.98      0.91      0.94       268

avg / total       0.95      0.94      0.94       539

Accuracy: 0.9443413729128015
2017-07-02 08:29:40,709 DEBUG Evaluation done in 0:00:26.602921
2017-07-02 08:29:40,721 INFO Building the selected model on the whole data set...
Hyper parameters:
{'clf': AdaBoostClassifier(algorithm='SAMME.R',
          base_estimator=ExtraTreesClassifier(bootstrap=False, class_weight=None, criterion='gini',
           max_depth=17, max_features='log2', max_leaf_nodes=40,
           min_impurity_split=1e-05, min_samples_leaf=1,
           min_samples_split=6, min_weight_fraction_leaf=0.0,
           n_estimators=600, n_jobs=-1, oob_score=False,
           random_state=<mtrand.RandomState object at 0x7ff2fe51c7e0>,
           verbose=0, warm_start=False),
          learning_rate=1.0, n_estimators=50,
          random_state=<mtrand.RandomState object at 0x7ff2fe51c828>),
 'clf__algorithm': 'SAMME.R',
 'clf__base_estimator__bootstrap': False,
 'clf__base_estimator__class_weight': None,
 'clf__base_estimator__criterion': 'gini',
 'clf__base_estimator__max_depth': 17,
 'clf__base_estimator__max_features': 'log2',
 'clf__base_estimator__max_leaf_nodes': 40,
 'clf__base_estimator__min_impurity_split': 1e-05,
 'clf__base_estimator__min_samples_leaf': 1,
 'clf__base_estimator__min_samples_split': 6,
 'clf__base_estimator__min_weight_fraction_leaf': 0.0,
 'clf__base_estimator__n_estimators': 600,
 'clf__base_estimator__n_jobs': -1,
 'clf__base_estimator__oob_score': False,
 'clf__base_estimator__random_state': <mtrand.RandomState object at 0x7ff2fe51c7e0>,
 'clf__base_estimator__verbose': 0,
 'clf__base_estimator__warm_start': False,
 'clf__learning_rate': 1.0,
 'clf__n_estimators': 50,
 'clf__random_state': <mtrand.RandomState object at 0x7ff2fe51c828>,
 'select': SelectKBest(k=411500, score_func=<function chi2 at 0x7ff3172282f0>),
 'select__k': 411500,
 'select__score_func': <function chi2 at 0x7ff3172282f0>}
2017-07-02 08:29:40,724 DEBUG Generating feature vector...
Vector union has 1863572 features.
2017-07-02 08:31:25,525 INFO Generated vector of 1863572 features in 0:01:44.800141 from 2155 samples.
2017-07-02 08:33:57,322 DEBUG Fitted 2155 data points.
2017-07-02 08:33:57,323 DEBUG Fitting done in 0:02:31.797429
Model saved as model_2017-07-02--08-29-40.pkl
